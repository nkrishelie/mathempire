% !TeX encoding = windows-1251
\documentclass[a4paper,11pt]{article}
\usepackage[mag=1000]{newlistok}

\ВключитьКолонтитул

\УвеличитьШирину{1.4cm}
\УвеличитьВысоту{2.3cm}

\Заголовок{Математическое ожидание}
\НомерЛистка{38}
% \renewcommand{\spacer}{\vspace{0.9pt}}
\ДатаЛистка{02.10 -- 16.10.2019}
% 54 задач
\Оценки{27/21/15}

\long\def\решение#1\крешение{}\long\def\ответ#1\кответ{} % Скрыть решения
\begin{document}


\СоздатьЗаголовок


\опр
Часто каждому возможному исходу соответствует какое-то число.
Например, число, написанное на выпавшей грани игрального кубика.
Или сумма денег, которую мы получим от казино в случае выпадения комбинации.
Тогда можно поинтересоваться, какое же число выпадает \textit{в среднем}.
Математики называют это <<в среднем>> {\it матожиданием} выпавшего числа.
\копр



\задача
Вам предлагают сыграть в игру.
Вы платите 100 рублей и дважды бросаете игральную кость.
Если сумма равна 12, то вам возвращают 1000 рублей.
Стоит ли соглашаться?
\кзадача
\ответ
Нет, не стоит.
\кответ
\решение
Вероятность выпадения $12$ есть $1/36$, так что матожидание выигрыша равно $900 \cdot \dfrac{1}{36} + (-100) \cdot \dfrac{35}{36} = \\ = \dfrac{-2600}{36} < 0$
\крешение












% \задача
% Каждый из двух игроков пишет на бумажке число 1 или 2, после чего
% они одновременно открывают бумажки.
% Если числа совпали, то первый платит второму столько рублей, каковы эти числа; если нет --- второй платит первому $a$ рублей.
% При каком значении $a$ эта игра будет честной?
% \кзадача
%\ответ

%\кответ
%\решение

%\крешение












\задача
Каждый из двух игроков пишет на бумажке число 1 или 2, после чего
они одновременно открывают бумажки.
Если числа совпали, то первый платит второму столько рублей, каковы
эти числа; если нет --- второй платит первому $a$ рублей.
При каком значении $a$ эта игра будет честной?
Разберите три случая:
\сНовойСтроки
\пункт
Каждый игрок равновероятно выбирает 1 или 2.
\пункт
Первый выбирает 1 с вероятностью $p$, а второй выбирает 1 с вероятностью $q$ (где $0\leq p,q\leq1$).
\спункт
Каждый игрок может использовать любую стратегию, при которой вероятность его выигрыша будет максимальной.
\кзадача
\ответ
\textbf{а}) $a=3/2$; \textbf{б}) $a=\dfrac{2-2p-2q+3pq}{p+q-2pq}$.
\кответ
\решение
\textbf{а}) Имеем три исхода: в четверти случаев первый платит рубль, в четверти -- два рубля, в половине -- зарабатывает $a$ рублей. Матожидание равно $-1/4-2/4+a/2=(2a-3)/4$, что равно нулю только при $a=3/2$.
\\\textbf{б}) Аналогично вычисляем матожидание как $-pq-2(1-p)(1-q)+ap(1-q)+aq(1-p) = -2+2p+2q-3pq+a(p+q-2pq)$, что равно нулю при $a=\dfrac{2-2p-2q+3pq}{p+q-2pq}$.
\крешение
















\опр
Пусть $(\Omega,\A, P)$ --- вероятностное пространство.
\выд {Случайной величиной} называется любая функция $\xi:\Omega\to\R$ (читается <<функция кси из множества омега в действительные числа>>), для которой для любого числа $t\in\R$ множество таких исходов
$\om\in\Om$, что $\xi(\om)\le t$ является событием, то есть $\{\om\in\Om\mid\xi(\om)\le t\}\in\A$.
Вероятность этого события обозначается через $P(\xi\le t)$.
% \emph{Математическим ожиданием} случайной величины $\xi$ называется число
% $$E\xi = \sum_{\omega \in \Omega} \xi(\omega) P(\omega).$$
\\Обратите внимание: каждая случайная величина — это вполне конкретная функция.
Случайного в ней только то, что она ставит в соответствие число каждому случайному исходу.
\\
Функция $F_\xi(t) = P(\xi\le t)$ называется \выд{функцией распределения} случайной величины.
\\
\выд{Cумма двух случайных величин} на одном и том же ВП --- это просто сумма функций.
\копр




\пзадача
Нарисуйте график функции распределения:
  \пункт
  случайной величины, равной числу, выпадающему на игральном кубике;
  \пункт
  случайного числа на отрезке $[0,1]$;
  \пункт
  расстояние до центра мишени радиуса $1$ от точки попадания точечной пули.
  \пункт
  Докажите, что функция распределения монотонно неубывает.
\кзадача
\решение
\textbf{а}) $P(\xi < 1) = 0$, $P(\xi \le 6) = 1$. В промежутках есть ещё 5 ступенек.
\textbf{б}) $P(\xi \le 0) = 0$, $P(\xi \le 1) = 1$. В промежутке отрезок.
\textbf{в}) Отношение площадей области $(\xi\le t)$ и $(\xi\le 1)$ равно $t^2$.
Поэтому получаем слева от 0 — 0, справа от 1 — 1, а на $[0,1]$ — просто $t^2$.
\крешение


\опр
Пусть $(\Omega,\A, P)$ --- конечное или счётное вероятностное пространство.
\emph{Математическим ожиданием} случайной величины $\xi$ называется число
$E\xi = \sum\limits_{\omega \in \Omega} \xi(\omega) P(\omega)$ (от слова \textit{expectation}).
\копр



\пзадача
В пакете лежат $n$ вкусных и $m$ невкусных конфеток, которые можно брать не глядя.
Чему равно матожидание количества извлечённых конфет до получения первой вкусной, если
  \пункт $n=1$ и $m=1$;
  \пункт $n=1$ и $m=2$;
  \пункт $n=2$ и $m=3$?
  \пункт
    Выразите это матожидание через аналогичное для меньшего числа конфет.
\кзадача
\ответ
\textbf{а}) $\dfrac{3}{2}$; \textbf{б}) 2; \textbf{в}) 2.
\кответ
\решение
Для того, чтобы извлечь вкусную конфету, потребуется сначала достать от 0 до $m$ невкусных, затем 1 вкусную.
\\\textbf{а}) $1\cdot\dfrac{1}{2} + 2\cdot\dfrac{1\cdot1}{2\cdot1} = \dfrac{3}{2}$;
\textbf{б}) $1\cdot\dfrac{1}{3} + 2\cdot\dfrac{2\cdot1}{3\cdot2} + 3\cdot\dfrac{2\cdot1\cdot1}{3\cdot2\cdot1} = \dfrac{2}{1} = 2$;
\medskip
\\\textbf{в}) $1\cdot\dfrac{2}{5} + 2\cdot\dfrac{3\cdot2}{5\cdot4} + 3\cdot\dfrac{3\cdot2\cdot2}{5\cdot4\cdot3} + 4\cdot\dfrac{3\cdot2\cdot1\cdot2}{5\cdot4\cdot3\cdot2} = \dfrac{2}{1} = 2$;
\medskip
\\\textbf{г}) $E(n, m) = \underbrace{1\cdot\dfrac{n}{n+m}}_{\text{сразу}} + \underbrace{\br{E(n, m - 1) + 1}\cdot\dfrac{m}{n+m}}_{\text{не сразу}}$

\крешение




\задача
Предположим, случайная величина $\xi$ принимает значения в $\N$.
Покажите, что формулу для её матожидания можно переписать так: $E\xi = \sum_{i=1}^\infty i \cdot P(\xi = i)$ или $E\xi = \sum_{i=1}^\infty P(\xi \ge i)$.
\кзадача


% \задача
% Дайте формальное определение \emph{математического ожидания} случайной величины $\xi$ для конечного вероятностного пространства.
% \\ Обозначение: $E\xi$ (от слова \textit{expectation}).
% \кзадача
% \ответ
% Возможны, например, такие определения: $E \xi = \sum_{\omega \in \Omega} \xi(\omega) P(\{\omega\})$, $E \xi = \sum_{t \in \mathbb{R}} t P(\xi = t)$.
% \кответ










\пзадача[Линейность матожидания]
Пусть случайная величина $\xi$ раскладывается в сумму некоторого числа более простых случайных величин: $\xi = \xi_1 + \xi_2 + \ldots + \xi_k$.
Докажите что тогда $E\xi = E\xi_1 + E\xi_2 + \ldots + E\xi_k$.
\кзадача
\решение
Воспользуемся первым определением: $E \xi = \sum_{\omega \in \Omega} \xi(\omega) P(\{\omega\}) = \sum_{\omega \in \Omega} \xi_1(\omega) + \ldots + \xi_k(\omega) P(\{\omega\}) = \\ = \sum_{\omega \in \Omega} \xi_1(\omega) P(\{\omega\}) + \ldots + \sum_{\omega \in \Omega} \xi_k(\omega) P(\{\omega\}) = E \xi_1 + \ldots + E \xi_k$.
\крешение












\задача
50 мужчин и 50 женщин случайно рассаживаются за круглый стол.
Назовем мужчину довольным, если рядом с ним сидит женщина.
Для каждого мужчины введем случайную величину равную 1, если он окажется доволен, и 0 иначе.
Найдите матожидание
\пункт такой случайной величины;
\пункт числа довольных мужчин.
\кзадача
\ответ
\textbf{а}) $\dfrac{99 \cdot 98 - 49 \cdot 48}{99 \cdot 98} = \dfrac{7350}{99 \cdot 98}=\dfrac{25}{33}$;
\textbf{б}) $\dfrac{183750}{99 \cdot 49} =\dfrac{1250}{33} = 37{,}(87)$.
\кответ
\решение
\textbf{а}) Вероятность того, что с обоих сторон от мужчины сидят мужчины, равна $\dfrac{49 \cdot 48}{99 \cdot 98}$, соответственно, дополнительная вероятность $\dfrac{99 \cdot 98 - 49 \cdot 48}{99 \cdot 98}=\dfrac{7350}{99 \cdot 98}$, равна матожиданию этой величины.
\textbf{б}) По линейности нужно умножить ответ предыдущего пункта на $50$.
\крешение










\задача
Проводятся $n$ опытов, в каждом опыте может произойти определенное событие (<<успех>>) с вероятностью $p$ (или не произойти --- <<неудача>> --- с вероятностью $q=1-p$).
Найдите матожидание числа смен успеха на неудачу и неудачи на успех.
\кзадача
\ответ
$(n-1)(1-p^2-q^2)$.
\кответ
\решение
Для каждой пары соседних опытов вероятность того, что их результаты не совпадают, равна $1-p^2-q^2$. По линейности число смен результата равно этой вероятности умножить на число пар соседних опытов.
\крешение




\ЛичныйКондуит{0mm}{6mm}
\ОбнулитьКондуит
\newpage





\пзадача
В магазин послали $n$ школьников, вручив список из $m$ нужных предметов.
Школьники потеряли список.
Школьник помнит конкретный нужный предмет с вероятностью $p$.
Найдите математическое ожидание количества нужных предметов, которые школьники смогут коллективно вспомнить.
\кзадача
\ответ
$m(1-(1-p)^n)$.
\кответ
\решение
Для каждого предмета введём величину, равную $1$, если его удалось вспомнить, и $0$ иначе. Так как вероятность не вспомнить предмет равна $(1-p)^n$, то дополнительная вероятность, равная матожиданию такой величины, равна $1-(1-p)^n$. По линейности матожидание числа предметов, которые удалось вспомнить, в $m$ раз больше.
\крешение












\задача
Собралось $k$ случайных людей.
Найдите матожидание числа пар людей с совпадающими днями рождения (для простоты можно считать, что никто не родился 29 февраля).
\кзадача
\ответ
$\dfrac{k(k-1)}{2 \cdot 365}$.
\кответ
\решение
Для каждой неупорядоченной пары людей вероятность совпадения из дней рождения равна $1/365$. По предыдущим соображениям нужно умножить её на число таких пар.
\крешение











\пзадача
Если человек стоит в очереди минуту, будем говорить, что бесцельно затрачена одна человеко-минута. В очереди в банке стоит восемь человек, из них пятеро планируют простые операции, занимающие 1 минуту, а трое планируют операции, занимающие 10 минут.
Рассмотрим суммарное количество бесцельно затраченных человеко-минут, найдите его
\пункт наименьшее и наибольшее возможное значения;
\пункт математическое ожидание, при условии, что порядок людей в очереди случаен.
\кзадача
\ответ
\textbf{а}) $55$, $190$; \textbf{б}) $\dfrac{35}{8} \cdot 28 =\dfrac{245}{2} = 122{,}5$.
\кответ
\решение
\textbf{а}) Очевидно, что нужно поставить троих людей со сложным операциями в начало или конец. В первом случае получится $10 \cdot 7 + 10 \cdot 6 + 10 \cdot 5 + 1 \cdot 4 + \ldots + 1 \cdot 1 = 180+10=190$, во втором -- $1 \cdot 7 + \ldots + 1 \cdot 3 + 10 \cdot 2 + 10 \cdot 1 = 25+30=55$.
\textbf{б}) Если человек стоит в очереди, и перед ним стоит $k$ человек, то из них в среднем $3k/8$ стоят $10$ минут, а $5k/8$ стоят $1$ минуту. Таким образом, среднее затраченное им число минут равно $\dfrac{10 \cdot 3k+1 \cdot 5k}{8} = \dfrac{35}{8} k$. Остаётся просуммировать по $k=1,\ldots,7$.
\крешение









\задача
Игра в «супершахматы» ведётся на доске размером $100\times100$, и в ней участвует 20 различных фигур, каждая из которых ходит по своим правилам.
Известно, что любая фигура с любого места бьет не более 20 полей.
Докажите, что можно расставить на доске все 20 фигур так, чтобы ни одна из них не била другую.
\кзадача

\решение
Мы рассмотрим случайную расстановку фигур и докажем, что матожидание числа пар бьющих фигур не превосходит $1$. В самом деле, для каждой упорядоченной пары фигур вероятность боя равна $\dfrac{20}{9\,999}$, так как всего таких пар $380$, получаем матожидание, равное $\dfrac{20\cdot 380}{9\,999}=\dfrac{7600}{9\,999} < 1$.
\крешение














\пзадача
Монетка падает орлом вверх
\пункт с вероятностью $1/2$;
\спункт с вероятностью $p$. %$1/3$.
\\Найдите матожидание числа подбрасываний этой монетки до выпадения первого орла.
\кзадача
\ответ
\textbf{а}) $2$; \textbf{б}) $\dfrac{1}{p}$.
\кответ
\решение
\textbf{б}) Воспользуемся вторым определением: $E T = \sum_{n=1}^{\infty} n P_n$, где $P_n$ -- вероятность того, что в первых $n-1$ подбрасываниях выпадёт решка, а в следующем, $n$-ом, орёл. Таким образом, $P_n = p(1-p)^{n-1}$, и $ET= p \sum_{n=1}^{\infty} n(1-p)^{n-1} = \\ = p \sum_{m \leq n} (1-p)^{n-1} = p \sum_{m=1}^{\infty} \sum_{n=m}^{\infty} (1-p)^n = p \sum_{m=1}^{\infty} (1-p)^m \dfrac{1}{1-(1-p)} = \sum_{m=1}^{\infty} (1-p)^{m} = \dfrac{1}{p}$.
\\\textbf{а}) Частный случай второго пункта.
\крешение











\задача
Школьнику нужно правильно ответить на вопрос с $n$ вариантами ответа.
Он ничего не знает и каждый раз даёт случайный ответ.
Найдите матожидание числа его попыток до правильного ответа, если он
\пункт запоминает, какие ответы он уже давал;
\спункт даже не запоминает.
\кзадача
\ответ
\textbf{а}) $\dfrac{n+1}{2}$ \textbf{б}) $n$.
\кответ
\решение
\textbf{а}) Можно считать, что школьник случайным образом переставляет ответы, и даёт правильный ответ с попытки $k$, если он стоит в этой перестановке на $k$-ом месте. Для всех $k$ есть ровно $(n-1)!$ перестановок с таким свойством, поэтому искомое матожидание равно $\sum_{k=1}^n k \cdot \dfrac{1}{n} = \dfrac{n(n+1)}{2n} = \dfrac{n+1}{2}$.
\textbf{б}) Частный случай задачи про монетку.
\крешение














%
%
% \задача
% Вдоль дороги стоит $n$ фонарей.
% Дорожная служба меняет все перегоревшие фонари как только перегорают два соседних фонаря.
% Каждый фонарь перегорает независимо от других.
% Найдите матожидание числа фонарей, которые придётся поменять при очередной замене.
% \кзадача
% \ответ
%
% \кответ
% \решение
%
% \крешение
%
%










\задача
$n$ претендентов на должность в случайном порядке приходят на собеседование.
Если в результате собеседования выясняется, что новый претендент лучше того, кто в данный момент занимает должность, первого нанимают, а последнего --- увольняют.
\пункт С какой вероятностью $k$-й по силе претендент будет нанят в какой-либо момент.
\пункт Найдите матожидание числа увольнений.
\кзадача
\ответ
\textbf{а}) $1/k$; \textbf{б}) $1/2 + 1/3 + ... + 1/n \approx \ln n - 0{,}42$.
\\$n = 1, E = 0 \approx 0.0$, $n = 2, E = 1/2 \approx 0.5$, $n = 3, E = 5/6 \approx 0.83$, $n = 4, E = 13/12 \approx 1.1$, $n = 5, E = 77/60 \approx 1.3$.
\кответ
\решение
\textbf{а}) Он будет нанят в том и только в том случае, когда никакой из $k-1$ более сильного претендента не стоит в очереди раньше него. Так как порядок $k$ сильнейших случаен, вероятность того, что первый среди них будет самым слабым, равна $1/k$.
\textbf{б})
Матожидание числа увольнений равна матожиданию числа принятых минус 1.
Рассмотрим случайную величину $\xi_i$ равную 1, если $i$-й по силе был принят, и 0, иначе.
Итоговое матожидание равно $\xi_1+\xi_2+\ldots+\xi_n-1$.
Получается $1+1/2+1/3+...+1/n - 1 = 1/2 + 1/3 + ... + 1/n$.
Асимптотически получается $\ln n + 0.58 - 1 = \ln n - 0{,}42$.
\крешение











\задача
Чтобы сгенерировать перестановку чисел от 1 до $n$, возьмём число 1 и случайно выберем число, в которое оно переходит. Потом случайно выберем число, в которое переходит только что выбранное число и т.д., пока цикл не замкнётся. Будем строить этим методом цикл за циклом, начиная с наименьшего из ещё не выбранных чисел.
\пункт Докажите что все перестановки получатся с равной вероятностью.
\пункт Чему равна вероятность того, что первый цикл имеет длину $m$.
\пункт Найдите матожидание числа циклов в случайной перестановке.
\пункт Найдите матожидание числа пассажиров, сидящих не на своих местах, в задаче про сумашедшую старушку.
\кзадача
\ответ
\textbf{б}) $\dfrac{1}{n}$; \textbf{в}) $1+\dfrac{1}{2}+\ldots+\dfrac{1}{n}$; \textbf{г})
\кответ
\решение
\textbf{а}) Для каждой конкретной перестановки вероятность того, что $1$ перейдёт в нужное место, равна $1/n$, что следующее число попадёт куда нужно -- $1/(n-1)$, и так далее, итого имеем $1/n!$.
\textbf{б}) Для этого нужно, чтобы первые $m-1$ чисел попали не на место единицы, а $m$-ое -- на место единицы. При этом для $i$-ого числа вероятность туда попасть равна $1/(n+1-i)$, так что имеем $\dfrac{(n-1) \cdot (n-2) \cdot (n-m+1)}{n \cdot (n-1) \cdot \ldots (n-m+2)} \cdot \dfrac{1}{n-m+1} = \dfrac{1}{n}$.
\textbf{в}) Если мы обозначим это матожидание через $E_n$, то по предыдущему $E_n = \sum_{m=1}^n \dfrac{1}{n} (E_{n-m} + 1) = 1 + \dfrac{E_1+\ldots + E_{n-1}}{n}$, откуда по индукции легко доказываем ответ.
\textbf{г}) Если мы обозначим это матожидание через $F_n$, то старушка, садясь на место $m$-ого пассажира $(m>1)$, пропускает $m-1$ пассажира, и сводит задачу к задаче с $n-m$ пассажирами, так что $F_n = \sum_{m=2}^n \dfrac{1}{n} (1 + F_{n-m})$, откуда по индукции легко получаем ответ.
\крешение
















\сзадача
Пачка жевачки содержит один из $n$ разных, но равновероятных вкладышей.
Сколько пачек нужно в среднем купить, чтобы собрать полную коллекцию вкладышей?
Чему равно число для $n=30$?
\кзадача
\ответ
$n\hr{1+\dfrac{1}{2}+\ldots+\dfrac{1}{n}}\approx n \hr{\ln n + 0{,}58 + \dfrac{1}{2n}}$;
При $n=30$ получаем $\dfrac{9304682830147}{77636318760}\approx119{.}85$ (по примерной формуле $119{,}94$).
\кответ
\решение
Введём случайные величины $T_k$, равные числу пачек, которые мы купили, когда у нас было $k$ вкладышей, пока нам не попался очередной новый. Тогда ясно, что искомое величина равна сумме $T_0+\ldots T_{k-1}$. Если мы уже собрали $k$ вкладышей, то вероятность получить новый на каждом шаге равна $\dfrac{n-k}{n}$.
По задаче 4 в среднем мы достигнем этого через $\dfrac{n}{n-k}$ шагов.
Осталось просуммировать по всем $k=0,\ldots,n-1$.
\крешение










%
%
% \сзадача
% В расписании движения автобусов на остановке
% \лк Университет\пк\ написано, что
% Средний интервал движения автобуса \No 57 равен 35 минут, а средний интервал
% движения автобуса \No 179 равен 20 минут. Сколько в среднем нужно
% ждать
% \вСтрочку
% \пункт автобус \No 57;
% \пункт один из этих автобусов?
% \кзадача
% \ответ
% \textbf{а}) $17.5$ минут; \textbf{б})
% \кответ
% \решение
% \textbf{а}) Предположим, что автобусы ходят строго с равными интервалами\footnote{Ответ на задачу существенно зависит от распределения интервала. Например, если интервал имеет геометрическое распределение со средним $35$ минут, то в любой момент времени матожидание времени ожидания следующего автобуса равно $35$ минутам.} по $35$ минут. Если мы прибываем в случайное место на $35$-минутном интервале между автобусами, то в среднем мы ожидаем автобуса $17.5$ минут.
% \textbf{б}) Предположим, что время ожидания 57-ого автобуса равномерно распределено на отрезке $[0,35]$, а время ожидания 179-ого равномерно распределено на отрезке $[0,20]$, причём они независимы. Если первая величина больше $20$ (а это бывает с вероятностью $3/7$), то наше время ожидания тождественно равно второй со средним $10$. Иначе мы находимся в условиях задачи 18.
% \крешение
%
%










\сзадача
На отрезке длины 1 случайным образом выбирают две точки, которые делят его на 3 части.
Найдите матожидание координаты самой левой из них.
\кзадача
\ответ
$\dfrac{1}{3}$.
\кответ
\решение
Если первая из выбранных точек имеет координату $x$, то с вероятностью $1-x$ искомая величина равна $x$, а с вероятностью $x$ она распределена равномерно на отрезке $[0,x]$, так что имеет среднее $x/2$, и итого её условное матожидание при зафиксированной первой точке равно $(1-x)x+x \dfrac{x}{2} = x - \dfrac{x^2}{2}$. Следовательно, итоговое матожидание равно $\int\limits_0^1 1 - \dfrac{x^2}{2} dx = \dfrac{1}{3}$. \footnote{Используя аргументы разной степени вразумительности, можно переформулировать задачу в терминах нахождения координат центра масс прямоуголльного треугольника с координатами вершин $(0,0)$, $(0,1)$ и $(1,0)$, что можно трактовать элементарными методами.}
\крешение










% Ответ — 1/3



\ЛичныйКондуит{0mm}{6mm}
% \GenXMLW
\end{document}


